!function(){"use strict";angular.module("app",["applicat.push.service","ionic","ngCordova","ngResource","ngTemplates","permission","ui.bootstrap.tpls","ui.bootstrap.datepicker"]).run(["$ionicPlatform","$rootScope","$stateParams","$state","AuthService","Permission","$window","PushService",function(e,t,o,n,r,a,i,s){r.init(),console.log(a),a.defineRole("user",function(){var e=r.getUser();return console.log(e),e?!0:!1}),e.ready(function(){i.cordova&&i.cordova.plugins.Keyboard&&(i.cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),s.registerDevice()),i.StatusBar&&i.StatusBar.styleDefault()}),n.go("main.home")}]).config(["$stateProvider","$httpProvider",function(e,t){t.interceptors.push("AuthInterceptor"),e.state("login",{url:"/login",templateUrl:"state/login/login.html",controller:"LoginController as Login"}).state("main",{"abstract":!0,url:"/main",templateUrl:"state/main/main.html",controller:"MainController as Main"}).state("main.home",{url:"/home",views:{main:{templateUrl:"state/mainHome/mainHome.html",controller:"MainHomeController as Home"}},data:{permissions:{only:["user"],redirectTo:{otherwise:{state:"login"}}}}}).state("main.daumMap",{url:"/daumMap/:from",views:{main:{templateUrl:"state/daumMap/daumMap.html",controller:"DaumMapController as Map"}},data:{permissions:{only:["user"],redirectTo:{otherwise:{state:"login"}}}}}).state("main.detail",{url:"/detail/:id",views:{main:{templateUrl:"state/detail/detail.html",controller:"DetailController as Detail"}},data:{permissions:{only:["user"],redirectTo:{otherwise:{state:"login"}}}}}).state("main.schedule",{url:"/schdule/:id/:selectedDate",views:{main:{templateUrl:"state/schedule/schedule.html",controller:"ScheduleController as Schedule"}},data:{permissions:{only:["user"],redirectTo:{otherwise:{state:"login"}}}}}).state("main.balance",{url:"/balance","abstract":!0,views:{main:{templateUrl:"state/balance/balance.html",controller:"BalanceController as Balance"}}}).state("main.balance.list",{url:"/list",views:{balance:{templateUrl:"state/balance/list/balanceList.html",controller:"BalanceListController as BalanceList"}},data:{permissions:{only:["user"],redirectTo:{otherwise:{state:"login"}}}}}).state("main.balance.detail",{url:"/detail/:placeName/:points",views:{balance:{templateUrl:"state/balance/detail/balanceDetail.html",controller:"BalanceDetailController as BalanceDetail"}},data:{permissions:{only:["user"],redirectTo:{otherwise:{state:"login"}}}}}).state("main.cancel",{url:"/cancel",views:{main:{templateUrl:"state/cancel/cancel.html",controller:"CancelController as Cancel"}},data:{permissions:{only:["user"],redirectTo:{otherwise:{state:"login"}}}}}).state("main.favorite",{url:"/favorite",views:{main:{templateUrl:"state/favorite/favorite.html",controller:"FavoriteController as Favorite"}},data:{permissions:{only:["user"],redirectTo:{otherwise:{state:"login"}}}}}).state("main.show",{url:"/show","abstract":!0,views:{main:{templateUrl:"state/show/show.html",controller:"ShowController as Show"}}}).state("main.show.list",{url:"/list",views:{show:{templateUrl:"state/show/list/showList.html",controller:"ShowListController as ShowList"}},data:{permissions:{only:["user"],redirectTo:{otherwise:{state:"login"}}}}}).state("main.show.savedList",{url:"/savedList",views:{show:{templateUrl:"state/show/savedShow/savedShowList.html",controller:"SavedShowListController as SavedShowList"}},data:{permissions:{only:["user"],redirectTo:{otherwise:{state:"login"}}}}}).state("main.show.detail",{url:"/detail/:id",views:{show:{templateUrl:"state/show/detail/showDetail.html",controller:"ShowDetailController as ShowDetail"}},data:{permissions:{only:["user"],redirectTo:{otherwise:{state:"login"}}}}}).state("main.announcements",{"abstract":!0,url:"/announcements",views:{main:{templateUrl:"state/announcements/announcements.html",controller:"AnnouncementsController as Announcements"}}}).state("main.announcements.eventList",{url:"/eventList",views:{announcements:{templateUrl:"state/announcements/event/eventList.html",controller:"EventListController as EventList"}},data:{permissions:{only:["user"],redirectTo:{otherwise:{state:"login"}}}}}).state("main.announcements.eventDetail",{url:"/eventDetail/:id",views:{announcements:{templateUrl:"state/announcements/event/eventDetail.html",controller:"EventDetailController as EventDetail"}},data:{permissions:{only:["user"],redirectTo:{otherwise:{state:"login"}}}}}).state("main.announcements.noticeList",{url:"/noticeList",views:{announcements:{templateUrl:"state/announcements/notice/noticeList.html",controller:"NoticeListController as NoticeList"}},data:{permissions:{only:["user"],redirectTo:{otherwise:{state:"login"}}}}}).state("main.announcements.noticeDetail",{url:"/noticeDetail/:id",views:{announcements:{templateUrl:"state/announcements/notice/noticeDetail.html",controller:"NoticeDetailController as NoticeDetail"}},data:{permissions:{only:["user"],redirectTo:{otherwise:{state:"login"}}}}})}])}(),function(){"use strict";angular.module("app").constant("governorUrl","http://todaynail.applicat.co.kr").constant("appName","todayNail").constant("kakaoKey","42022d8578d6fb558d70ae75766ee900").constant("facebookKey","983668071678162").constant("googlePushSenderID","282095615414")}(),function(){"use strict";function e(e,t,o){var n=t+"/booking/:list/:image/:mine/:dateBetween/:request",r={list:"@list",image:"@image",mine:"@mine",dateBetween:"@dateBetween"},a={getBookings:{method:"GET",params:{list:"list"}},getMyBookings:{method:"GET",params:{list:"list",mine:"mine"}},getBookingsDateBetween:{method:"GET",params:{dateBetween:"dateBetween"}},findById:{method:"GET"},createBooking:{method:"POST"},requestBooking:{method:"POST",params:{request:"request"}},updateBooking:{method:"PUT",isArray:!0,headers:{"Content-Type":"text/plain"}},removeBooking:{method:"DELETE"}},i=e(n,r,a);return i.createBookingWithImage=function(e,n){angular.extend(n,e);var r=n.file;delete n.file;var a={params:n,chunkedMode:!1};return{$promise:o.upload(t+"/booking/image",r,a)}},i.updateBookingWithImage=function(e,n){angular.extend(n,e);var r=n.file;delete n.file;var a={params:n,chunkedMode:!1,httpMethod:"PUT"};return{$promise:o.upload(t+"/booking/image",r,a)}},i}angular.module("app").factory("Bookings",e),e.$inject=["$resource","governorUrl","$cordovaFileTransfer"]}(),function(){"use strict";function e(e,t){var o=t+"/post/comment",n={},r={addCommentToPost:{method:"POST"}},a=e(o,n,r);return a}angular.module("app").factory("Comments",e),e.$inject=["$resource","governorUrl"]}(),function(){"use strict";function e(e,t,o){var n=t+"/device/:sendMessageAll",r={sendMessageAll:"@sendMessageAll"},a={pushAll:{method:"GET",params:{sendMessageAll:"sendMessageAll"}},register:{method:"POST"},update:{method:"PUT"}},i=e(n,r,a);return i.getDeviceIdSync=function(){var e=o.getDeviceId();return e},i}angular.module("app").factory("Devices",e),e.$inject=["$resource","governorUrl","PushService"]}(),function(){"use strict";function e(e,t){var o=t+"/post/:like/:unlike",n={like:"@like",unlike:"@unlike"},r={likePost:{method:"POST"},unlikePost:{method:"DELETE"}},a=e(o,n,r);return a}angular.module("app").factory("Likes",e),e.$inject=["$resource","governorUrl"]}(),function(){"use strict";function e(e,t,o,n){var r=t+"/photo",a={},i={removePhoto:{method:"DELETE"}},s=e(r,a,i);return s.uploadPhoto=function(e,r){angular.extend(r,e);var a=r.file?r.file:"[]";delete r.file;var i={params:r,chunkedMode:!1,headers:{Connection:"close",Authorization:"Bearer "+o.getToken()}};return console.log(r),{$promise:n.upload(t+"/photo",a,i,!0)}},s}angular.module("app").factory("Photos",e),e.$inject=["$resource","governorUrl","AuthService","$cordovaFileTransfer"]}(),function(){"use strict";function e(e,t,o){var n=t+"/place/:list/:mine/:within/:image:photos",r={list:"@list",mine:"@mine",within:"@within",image:"@image",photos:"@photos"},a={getPlaces:{method:"GET",params:{list:"list"}},getMyPlaces:{method:"GET",params:{list:"list",mine:"mine"}},getPlacesWithin:{method:"GET",params:{list:"list",within:"within"}},getPlacePhotos:{method:"GET",params:{photos:"photos"},isArray:!0},findById:{method:"GET"},createPlace:{method:"POST"},createPlaceWithImage:{method:"POST",params:{image:"image"}},updatePlace:{method:"PUT"},updatePlaceWithImage:{method:"PUT",params:{image:"image"}},removePlace:{method:"DELETE"}},i=e(n,r,a);return i.createPlaceWithImage=function(e,n){angular.extend(n,e);var r=n.file;delete n.file;var a={params:n,chunkedMode:!1};return{$promise:o.upload(t+"/place/image",r,a)}},i.updatePlaceWithImage=function(e,n){angular.extend(n,e);var r=n.file;delete n.file;var a={params:n,chunkedMode:!1,httpMethod:"PUT"};return{$promise:o.upload(t+"/place/image",r,a)}},i}angular.module("app").factory("Places",e),e.$inject=["$resource","governorUrl","$cordovaFileTransfer"]}(),function(){"use strict";function e(e,t,o,n){var r=t+"/post/:list/:image/:mine/:like",a={list:"@list",image:"@image",mine:"@mine",like:"@like"},i={getPosts:{method:"GET",params:{list:"list"}},getMyPosts:{method:"GET",params:{list:"list",mine:"mine"}},findById:{method:"GET"},createPost:{method:"POST"},updatePost:{method:"PUT"},likePost:{method:"POST",params:{like:"like"}},removePost:{method:"DELETE"}},s=e(r,a,i);return s.createPostWithImage=function(e,r){angular.extend(r,e);var a=r.file?r.file:"[]";delete r.file,r.category="SHOW-POST";var i={params:r,chunkedMode:!1,headers:{Connection:"close",Authorization:"Bearer "+n.getToken()}};return console.log(r),{$promise:o.upload(t+"/post",a,i,!0)}},s.updatePostWithImage=function(e,r){angular.extend(r,e);var a=r.file;delete r.file;var i={params:r,chunkedMode:!1,httpMethod:"PUT",headers:{Connection:"close",Authorization:"Bearer "+n.getToken()}};return{$promise:o.upload(t+"/post",a,i,!0)}},s}angular.module("app").factory("Posts",e),e.$inject=["$resource","governorUrl","$cordovaFileTransfer","AuthService"]}(),function(){"use strict";function e(e,t,o){var n=t+"/product/:list/:image/:mine/:checkProductCode",r={list:"@list",image:"@image",mine:"@mine",checkProductCode:"@checkProductCode"},a={getProducts:{method:"GET",params:{list:"list"}},getMyProducts:{method:"GET",params:{list:"list",mine:"mine"}},checkProductCode:{method:"GET",params:{checkProductCode:"checkProductCode"}},findById:{method:"GET"},createProduct:{method:"POST"},updateProduct:{method:"PUT"},removeProduct:{method:"DELETE"}},i=e(n,r,a);return i.createProductWithImage=function(e,n){angular.extend(n,e);var r=n.file;delete n.file;var a={params:n,chunkedMode:!1};return{$promise:o.upload(t+"/product/image",r,a)}},i.updateProductWithImage=function(e,n){angular.extend(n,e);var r=n.file;delete n.file;var a={params:n,chunkedMode:!1,httpMethod:"PUT"};return{$promise:o.upload(t+"/product/image",r,a)}},i}angular.module("app").factory("Products",e),e.$inject=["$resource","governorUrl","$cordovaFileTransfer"]}(),function(){"use strict";function e(e,t){var o=t+"/royaltyPoint/:list/:mine",n={list:"@list",mine:"@mine"},r={getRoyaltyPoints:{method:"GET",params:{list:"list"}},getMyRoyaltyPoints:{method:"GET",params:{list:"list",mine:"mine"}},findById:{method:"GET"},createRoyaltyPoint:{method:"POST"},updateRoyaltyPoint:{method:"PUT",isArray:!0},removeRoyaltyPoint:{method:"DELETE"}},a=e(o,n,r);return a}angular.module("app").factory("RoyaltyPoints",e),e.$inject=["$resource","governorUrl"]}(),function(){"use strict";function e(e,t){var o=t+"/user",n={},r={},a=e(o,n,r);return a}angular.module("app").factory("Users",e),e.$inject=["$resource","governorUrl"]}(),function(){"use strict";function e(e){return e.daum?e.daum:void 0}angular.module("app").factory("daum",e),e.$inject=["$window"]}(),function(){"use strict";function e(e){return e.localStorage?e.localStorage:void 0}angular.module("app").factory("localStorage",e),e.$inject=["$window"]}(),function(){"use strict";function e(e){return e.moment?e.moment:void 0}angular.module("app").factory("moment",e),e.$inject=["$window"]}(),function(){"use strict";function e(e){return e._?e._:void 0}angular.module("app").factory("_",e),e.$inject=["$window"]}(),function(){"use strict";function e(e,t,o,n,r,a,i,s,l,c,u,d){function p(){return P}function m(){t.info("PushService - Register push notification");var e=null;ionic.Platform.isAndroid()?(t.info("PushService - Android push"+l),e={senderID:l}):ionic.Platform.isIOS()&&(t.info("PushService - IOS push"),e={badge:"true",sound:"true",alert:"true"}),e||t.info("PushService - Not a supported device"),n.register(e).then(function(e){t.info("PushService - Register success "+e),console.log("PushService - Register success "+e),ionic.Platform.isIOS()&&g(e,S)},function(e){t.info("PushService - Register error "+e)})}function f(n){var r=o.defer();return e({url:c+"/device",method:"PUT",headers:{"Content-Type":"application/json"},params:{deviceId:p(),active:n}}).success(function(e,o,n,a){t.info("PushService - Success updating device push settings "+JSON.stringify(e)),r.resolve(e)}).error(function(e,o,n,a){r.reject(e),t.info("PushService - Failed updating device push settings")}),r.promise}function g(n,r){var a={deviceId:n,platform:r,active:!0};t.info("PushService - register to server: "+JSON.stringify(a));o.defer();e({url:c+"/device",method:"POST",headers:{"Content-Type":"application/json"},data:a}).success(function(e,o,n,r){t.info("PushService - registered to server: "+JSON.stringify(e)),console.log("this is data"),console.log(e),v(e.device.deviceId),angular.isDefined(e.device.optionalType)&&setTradeNotification(e.device.optionalType)}).error(function(e,o,n,r){t.info("PushService - error: "+JSON.stringify(e))})}function h(e){switch(t.info("In foreground "+JSON.stringify(e)),e.event){case"registered":e.regid.length>0&&g(e.regid,$);break;case"message":t.info(JSON.stringify(e)),window.plugin.notification.local.schedule({title:e.payload.title,text:e.payload.message,icon:"res://icon.png",smallIcon:"res://pushicon.png"});break;case"error":t.info("error"),a.alert(e.msg,"Push notification error event");break;default:t.info("default"),a.alert(e.event,"Push notification handler - Unprocessed Event")}}function v(e){P=e}function y(e){}var $="ANDROID",S="IOS",P=null;this.getDeviceId=p,this.registerDevice=m,this.updateDeviceToken=f,s.$on("$cordovaPush:notificationReceived",function(e,t){ionic.Platform.isAndroid()?h(t):ionic.Platform.isIOS()&&y(t)})}angular.module("applicat.push.service",["ngCordova"]).service("PushService",e),e.$inject=["$http","$log","$q","$cordovaPush","$cordovaToast","$cordovaDialogs","$cordovaLocalNotification","$rootScope","googlePushSenderID","governorUrl","appName","LocalService"]}(),function(){"use strict";function e(e,t,o,n,r){return{request:function(e){var t=n.get(r+"_auth_token");return t&&(t=angular.fromJson(n.get(r+"_auth_token")).token),t&&(e.headers["Content-Type"]="application/json",e.headers.Authorization="Bearer "+t),e},responseError:function(t){if(401===t.status||403===t.status||405===t.status||498===t.status)"/login"!==o.path()?(n.unset(r+"_auth_token"),o.path("/login"),(null==t.data||void 0==t.data)&&(t.data={message:"권한이 없는 페이지이거나 로그인하지 않았습니다. 로그인해주세요."})):t.data.hideMessage=!0;else if(300===t.status){var a=null,i="";switch(t.data.redirectCode){case"ACTIVATE":a="/resend/false";break;case"RESET":a="/passReset"}o.path()!==a?(o.path(a),(null==t.data||void 0==t.data)&&(t.data={message:i})):t.data.hideMessage=!0}return e.reject(t)}}}function t(e,t,o,n,r,a,i,s,l,c){function u(e){d=e}var d=null,p={name:"어플리켓"};this.getUser=function(){return d},this.getApp=function(){return p},this.getToken=function(){var e=a.get(i+"_auth_token");return e?e=angular.fromJson(a.get(i+"_auth_token")).token:void n.go("login")},this.init=function(){var e=JSON.parse(a.get(i+"_auth_token"));null!=e&&null!=e.user&&u(e.user)},this.register=function(o){var n=t.defer();return e({url:r+"/user/register",method:"post",headers:{"Content-Type":"application/json"},params:o}).success(function(e,t,o,r){n.resolve(e)}).error(function(e,t,o,r){n.reject(e)}),n.promise},this.registerWithImage=function(e,t,o,n){var a=new FileUploadOptions,i=angular.copy(e);a.params=i,a.headers={Connection:"close"},a.chunkedMode=!1;var s=new FileTransfer;s.upload(t,encodeURI(r+"/user/registerWithImage"),o,n,a,!0)},this.login=function(o,n){var s=t.defer();return e({url:r+"/auth/local",method:"post",headers:{"Content-Type":"application/json"},data:{identifier:o,password:n}}).success(function(e,t,o,n){console.log(e),a.set(i+"_auth_token",JSON.stringify(e)),u(e.user),s.resolve(e)}).error(function(e,t,o,n){console.log(e),s.reject(e)}),s.promise},this.verifyResetCode=function(o,n){var s=t.defer();return e({url:r+"/user/passwordresetcomplete",method:"put",headers:{"Content-Type":"application/json"},data:{email:o,code:n}}).success(function(e,t,o,n){a.set(i+"_auth_token",JSON.stringify(e)),s.resolve(e)}).error(function(e,t,o,n){s.reject(e)}),s.promise},this.passReset=function(o){var n=t.defer();return e({url:r+"/user/resetStart",method:"post",headers:{"Content-Type":"application/json"},data:{email:o}}).success(function(e,t,o,r){n.resolve(e)}).error(function(e,t,o,r){n.reject(e)}),n.promise},this.logout=function(){a.unset(i+"_auth_token"),u(null),o.path("/login")},this.changePassword=function(o,n){var a=t.defer();return e({url:r+"/user/changePassword",method:"post",headers:{"Content-Type":"application/json"},data:{oldPassword:o,newPassword:n}}).success(function(e,t,o,n){a.resolve(e)}).error(function(e,t,o,n){a.reject(e)}),a.promise},this.checkNickname=function(o){var n=t.defer();return e({url:r+"/user/checknickname",method:"get",headers:{"Content-Type":"application/json"},params:{nickname:o}}).success(function(e,t,o,r){n.resolve(e)}).error(function(e,t,o,r){n.reject(e)}),n.promise},this.checkEmail=function(o){var n=t.defer();return e({url:r+"/user/checkEmail",method:"get",headers:{"Content-Type":"application/json"},params:{email:o}}).success(function(e,t,o,r){n.resolve(e)}).error(function(e,t,o,r){n.reject(e)}),n.promise},this.getMyProfile=function(){var o=t.defer();return e({url:r+"/user/profile",method:"get",headers:{"Content-Type":"application/json"}}).success(function(e,t,n,r){o.resolve(e)}).error(function(e,t,n,r){o.reject(e)}),o.promise},this.updateMyProfile=function(o){var n=t.defer();return e({url:r+"/user/update",method:"put",headers:{"Content-Type":"application/json"},data:{nickname:o}}).success(function(e,t,o,r){n.resolve(e)}).error(function(e,t,o,r){n.reject(e)}),n.promise},this.updateMyProfileWithImage=function(e,t,o,n){var a=new FileUploadOptions,i=angular.copy(e);a.params=i,a.httpMethod="PUT",a.headers={Connection:"close",Authorization:"Bearer "+this.getToken()},a.chunkedMode=!1;var s=new FileTransfer;s.upload(t,encodeURI(r+"/user/updateWithImage"),o,n,a,!0)},this.loginWithKakao=function(){var o=t.defer();return c.kakao(s).then(function(t){t.provider="kakao",console.log("kakao server result"),console.log(t),e({url:r+"/auth/register",method:"post",headers:{"Content-Type":"application/json"},data:t}).success(function(e,t,n,r){a.set(i+"_auth_token",JSON.stringify(e)),console.log("kakao response from server"),console.log(JSON.stringify(e,null,2)),console.log(JSON.stringify(e.user,null,2)),u(e.user),o.resolve({message:"done"})}).error(function(e,t,n,r){console.log(e),o.reject(e)})},function(e){o.reject(e)}),o.promise},this.loginWithFacebook=function(){var o=t.defer();return c.facebook(l,["email"]).then(function(t){t.provider="facebook",console.log("facebook server result"),console.log(t),e({url:r+"/auth/register",method:"post",headers:{"Content-Type":"application/json"},data:t}).success(function(e,t,n,r){a.set(i+"_auth_token",JSON.stringify(e)),u(e.user),console.log("facebook response from our server"),console.log(JSON.stringify(e,null,2)),console.log(JSON.stringify(e.user,null,2)),o.resolve({message:"done"})}).error(function(e,t,n,r){console.log(e,t,n,r),o.reject(e)})},function(e){o.reject(e)}),o.promise}}angular.module("app").factory("AuthInterceptor",e),e.$inject=["$q","$injector","$location","LocalService","appName"],angular.module("app").service("AuthService",t),t.$inject=["$http","$q","$location","$state","governorUrl","LocalService","appName","kakaoKey","facebookKey","$cordovaOauth"]}(),function(){"use strict";function e(e,t){function o(o){e(function(){var e=t.document.getElementById(o);e&&e.focus()})}var n={focusById:o};return n}angular.module("app").factory("Dom",e),e.$inject=["$timeout","$window"]}(),function(){"use strict";function e(e,t,o,n){function r(t){var o=n.getItem(t),r=angular.fromJson(o);Array.isArray(r)||(r=[]);for(var a=0;a<r.length;a++){var i=r[a];if(i.id===e.id)return!0}}function a(o,r,a,l){var c=n.getItem(o),u=angular.fromJson(c);Array.isArray(u)||(u=[]);for(var d=0;d<u.length;d++){var p=u[d];if(p.id===e.id)return u.splice(d,1),c=angular.toJson(u),n.setItem(o,c),r.styleFavorite=!1,t.popUp.alert["default"]("즐겨찾기 알림","즐겨찾기에서 삭제되었습니다."),!1}var m={id:a.current.id};i(a,m),console.log(m),u.push(m),c=angular.toJson(u),n.setItem(o,c),l&&s(l,m.id,a),r.styleFavorite=!0,t.popUp.alert["default"]("즐겨찾기 알림","즐겨찾기에 추가되었습니다.")}function i(e,t){if(e.current.name&&(t.name=e.current.name),e.current.title&&(t.title=e.current.title),e.current.photos.length>0&&(t.photos=[{url:e.current.photos[0].url}]),e.current.location&&(t.location={coordinates:e.current.location.coordinates}),e.current.address&&(t.address=e.current.address),e.current.createdBy&&(t.createdBy={},t.createdBy.nickname=e.current.createdBy.nickname),e.current.likes&&(t.likes=e.current.likes),e.current.comments){t.comments=[];for(var o=0;o<e.current.comments.length;o++)t.comments.push(1)}}function s(e,t,r){var a=n.getItem(e),i=angular.fromJson(a);Array.isArray(i)||(i=[]);for(var s=0;s<i.length;s++){var l=i[s];if(l===t)return!1}i.push(t),a=angular.toJson(i),n.setItem(e,a),o.likePost({post:t}).$promise.then(function(e){console.log("thisdata"),console.log(e),r.current.likes=e.posts[0].likes},function(e){console.log(e)})}var l={isFavorite:r,saveToFavorite:a};return l}angular.module("app").factory("Favorite",e),e.$inject=["$stateParams","Message","Posts","localStorage"]}(),function(){"use strict";angular.module("app").factory("LocalService",function(){return{get:function(e){return localStorage.getItem(e)},set:function(e,t){return localStorage.setItem(e,t)},unset:function(e){return localStorage.removeItem(e)},getSession:function(e){return sessionStorage.getItem(e)},setSession:function(e,t){return sessionStorage.setItem(e,t)},unsetSession:function(e){return sessionStorage.removeItem(e)}}})}(),function(){"use strict";function e(e,t){function o(t){e.show(t)}function n(t){e.show({template:'<h4 class="message-success">'+t+"</h4>",duration:2e3})}function r(t){e.show({template:'<h4 class="message-error">'+t+"</h4>",duration:2e3})}function a(){e.hide()}function i(e,o){return t.alert({title:e||"인터넷이 끊겼습니다.",template:o||"인터넷을 켜주세요."})}var s={loading:{"default":o,hide:a},message:{success:n,error:r},popUp:{alert:{"default":i}}};return s}angular.module("app").factory("Message",e),e.$inject=["$ionicLoading","$ionicPopup"]}(),function(){"use strict";function e(e,t,o){function n(n,r){return o.horizontalIonScrollCount||(o.horizontalIonScrollCount=0),o.horizontalIonScrollCount++,r.delegateHandle="horizontal"+o.horizontalIonScrollCount,function(n,r,a){t(function(){var t=a.delegateHandle,n=e.$getByHandle(t).getScrollView(),r=n.__container,i=n.touchStart,s=n.mouseDown,l=n.touchMove,c=n.mouseMove;r.removeEventListener("touchstart",n.touchStart),r.removeEventListener("mousedown",n.mouseDown),o.document.removeEventListener("touchmove",n.touchMove),o.document.removeEventListener("mousemove",n.mousemove),n.touchStart=function(e){e.preventDefault=function(){},i.apply(n,[e])},n.touchMove=function(e){e.preventDefault=function(){},l.apply(n,[e])},n.mouseDown=function(e){e.preventDefault=function(){},s&&s.apply(n,[e])},n.mouseMove=function(e){e.preventDefault=function(){},c&&c.apply(n,[e])},r.addEventListener("touchstart",n.touchStart,!1),r.addEventListener("mousedown",n.mouseDown,!1),o.document.addEventListener("touchmove",n.touchMove,!1),o.document.addEventListener("mousemove",n.mouseMove,!1)})}}return{scope:!0,restrict:"A",compile:n}}angular.module("app").directive("parentScroll",e),e.$inject=["$ionicScrollDelegate","$timeout","$window"]}(),function(){"use strict";function e(e){function t(t,o){o.on("click",function(){o.addClass("touch"),e(function(){o.removeClass("touch")},50)})}return{restrict:"A",link:t}}angular.module("app").directive("touch",e),e.$inject=["$timeout"]}(),function(){"use strict";function e(e,t){function o(o,n){e.vw=n.prop("offsetWidth"),t.addEventListener("resize",function(){e.$apply(function(){e.vw=n.prop("offsetWidth")})})}return{link:o}}angular.module("app").directive("vw",e),e.$inject=["$rootScope","$window"]}(),function(){"use strict";function e(){function e(e,t){var o=[];if(e)for(var n=0;n<e.length;n++)for(var r=e[n],a=0;a<r.tags.length;a++){var i=r.tags[a];i===t&&o.push(r)}return o}return e}angular.module("app").filter("filterByTag",e)}(),function(){"use strict";function e(e,t,o,n,r){function a(){i()}function i(){o.loading["default"](),t.get({id:n.id,populates:"photos"}).$promise.then(function(t){console.log(t),e.post=t.post,o.loading.hide()},function(e){console.log(e),o.popUp.alert["default"]("이벤트 알림","종료된 이벤트입니다.")})}var s=this;s.Model=e,r.$on("$ionicView.beforeEnter",a)}angular.module("app").controller("EventDetailController",e),e.$inject=["EventDetailModel","Posts","Message","$stateParams","$scope"]}(),function(){"use strict";function e(){var e={post:{id:"",comments:[],photos:[{url:""}],content:"",title:"",category:"SHOW-POST",createdBy:{nickname:""}}};return e}angular.module("app").factory("EventDetailModel",e)}(),function(){"use strict";function e(e,t,o,n,r){function a(e){o.go("main.announcements.eventDetail",{id:e.id})}function i(){var o=e.postsWrapper.posts;t.getPosts({category:"EVENT-POST",limit:10,newerThan:o[0].id,populates:"photos"}).$promise.then(function(e){e.posts.length||r.popUp.alert["default"]("이벤트 알림","새로운 이벤트가 없습니다."),e.posts.forEach(function(e){o.unshift(e)}),n.$broadcast("scroll.refreshComplete")},function(e){console.log(e),r.popUp.alert["default"](),n.$broadcast("scroll.refreshComplete")})}function s(){var o=e.postsWrapper.posts;t.getPosts({category:"EVENT-POST",sort:"id DESC",limit:10,olderThan:o[o.length-1].id,popluates:"photos"}).$promise.then(function(t){t.posts.forEach(function(e){o.push(e)}),n.$broadcast("scroll.infiniteScrollComplete"),e.postsWrapper.more=t.more},function(e){console.log(e),r.popUp.alert["default"](),n.$broadcast("scroll.infiniteScrollComplete")})}function l(){return e.postsWrapper.more}function c(){e.postsWrapper.posts.length<10&&(r.loading["default"](),t.getPosts({category:"EVENT-POST",sort:"id DESC",limit:10,populates:"photos"}).$promise.then(function(t){e.postsWrapper=t,console.log(t),r.loading.hide()},function(e){console.log(e),r.popUp.alert["default"]()}))}var u=this;u.Model=e,u.goToDetailHandler=a,u.getNewerPosts=i,u.getOlderPosts=s,u.checkForMore=l,n.$on("$ionicView.beforeEnter",c)}angular.module("app").controller("EventListController",e),e.$inject=["EventListModel","Posts","$state","$scope","Message"]}(),function(){"use strict";function e(){var e={postsWrapper:{posts:[{title:"",content:"",category:"",comments:[],photos:[{url:""}]}],more:!0}};return e}angular.module("app").factory("EventListModel",e)}(),function(){"use strict";function e(e,t,o,n,r){function a(){i()}function i(){r.loading["default"](),t.get({id:o.id,populates:"photos"}).$promise.then(function(t){console.log(t),e.post=t.post,r.loading.hide()},function(e){console.log(e),r.popUp.alert["default"]("공지사항 알림","없는 공지사항 입니다")})}var s=this;s.Model=e,n.$on("$ionicView.beforeEnter",a)}angular.module("app").controller("NoticeDetailController",e),e.$inject=["NoticeDetailModel","Posts","$stateParams","$scope","Message"]}(),function(){"use strict";function e(){var e={post:{id:"",comments:[],photos:[{url:""}],content:"",title:"",category:"NOTICE-POST",createdBy:{nickname:""}}};return e}angular.module("app").factory("NoticeDetailModel",e)}(),function(){"use strict";function e(e,t,o,n,r){function a(e){o.go("main.announcements.noticeDetail",{id:e.id})}function i(){var o=e.postsWrapper.posts;t.getPosts({category:"NOTICE-POST",limit:10,newerThan:o[0].id,populates:"photos"}).$promise.then(function(e){e.posts.length||r.popUp.alert["default"]("공지사항 알림","새로운 공지사항이 없습니다."),e.posts.forEach(function(e){o.unshift(e)}),n.$broadcast("scroll.refreshComplete")},function(e){console.log(e),r.popUp.alert["default"](),n.$broadcast("scroll.refreshComplete")})}function s(){var o=e.postsWrapper.posts;t.getPosts({category:"NOTICE-POST",sort:"id DESC",limit:10,olderThan:o[o.length-1].id,populates:"photos"}).$promise.then(function(t){t.posts.forEach(function(e){o.push(e)}),n.$broadcast("scroll.infiniteScrollComplete"),e.postsWrapper.more=t.more},function(e){console.log(e),r.popUp.alert["default"](),n.$broadcast("scroll.infiniteScrollComplete")})}function l(){return e.postsWrapper.more}function c(){e.postsWrapper.posts.length<10&&(r.loading["default"](),t.getPosts({category:"NOTICE-POST",sort:"id DESC",limit:10,populates:"photos"}).$promise.then(function(t){e.postsWrapper=t,console.log(t),r.loading.hide()},function(e){console.log(e),r.popUp.alert["default"]()}))}var u=this;u.Model=e,u.goToDetailHandler=a,u.getNewerPosts=i,u.getOlderPosts=s,u.checkForMore=l,n.$on("$ionicView.beforeEnter",c)}angular.module("app").controller("NoticeListController",e),e.$inject=["NoticeListModel","Posts","$state","$scope","Message"]}(),function(){"use strict";function e(){var e={postsWrapper:{posts:[{title:"",content:"",category:"",comments:[],photos:[{url:""}]}],more:!0}};return e}angular.module("app").factory("NoticeListModel",e)}(),function(){"use strict";function e(e,t,o,n){function r(){a.placeName=t.placeName,a.points=t.points,console.log(o.getUser())}var a=this;a.Model=e,a.placeName=null,a.points=null,a.username=o.getUser().username,n.$on("$ionicView.beforeEnter",r)}angular.module("app").controller("BalanceDetailController",e),e.$inject=["BalanceDetailModel","$stateParams","AuthService","$scope"]}(),function(){"use strict";function e(){var e={};return e}angular.module("app").factory("BalanceDetailModel",e)}(),function(){"use strict";function e(e,t,o,n,r,a,i){function s(){return t.getMyRoyaltyPoints({category:"NAIL-ROYALTYPOINT"}).$promise.then(function(t){console.log(t);var o=l(t.royaltyPoints);o.then(function(o){console.log(o);for(var n=i.pluck(t.royaltyPoints,"points"),r=i.pluck(o,"name"),a=i.pluck(o,"address"),s=i.pluck(i.pluck(i.pluck(o,"photos"),"0"),"url"),l=[],c=0;c<n.length;c++){var u={};u.name=r[c],u.royaltyPoints=n[c],u.address=a[c],u.url=s[c],l.push(u)}e.current.royaltyPointObjs=l,console.log(l)},function(e){console.log(e)})},function(e){console.log(e)})}function l(e){var t=i.pluck(e,"place"),n=i.map(t,function(e){return o.findById({id:e,populates:"photos"}).$promise}),r=a.all(n);return r}function c(e,t){return r.go(e,t)}function u(){s()}var d=this;d.Model=e,d.goToHandler=c,n.$on("$ionicView.beforeEnter",u)}angular.module("app").controller("BalanceListController",e),e.$inject=["BalanceListModel","RoyaltyPoints","Places","$scope","$state","$q","_"]}(),function(){"use strict";function e(){var e={current:{}};return e}angular.module("app").factory("BalanceListModel",e)}(),function(){"use strict";function e(e,t,o,n,r,a,i,s){function l(){return i.loading["default"](),t.findById({id:r.id,populates:"comments,photos"}).$promise.then(function(t){console.log(t.post),e.current=t.post,i.loading.hide()},function(e){console.log(e),i.loading.hide(),i.popUp.alert["default"]("해당포스트가 없습니다","지워진 포스트이거나 인터넷이 꺼져있습니다. 즐겨찾기에서 삭제해주세요")})}function c(t){o.addCommentToPost({},{content:t,post:r.id}).$promise.then(function(t){var o=t.createdBy;t.createdBy={},t.createdBy.nickname=n.user.nickname,t.createdBy.createdBy=o,console.log(t),i.popUp.alert["default"]("댓글달기 알림","댓글을 성공적으로 작성하셨습니다."),e.current.comments.push(t),d.comment=null},function(e){console.log(e),i.popUp.alert["default"]("댓글달기 알림","인터넷이 꺼져있습니다.")})}function u(){l(),d.styleFavorite=s.isFavorite("NAIL_SAVED_POSTS")}var d=this;

d.Model=e,d.toggleSavePost=s.saveToFavorite.bind(null,"NAIL_SAVED_POSTS",d,e,"NAIL_LIKED_ONCE"),d.addComment=c,a.$on("$ionicView.beforeEnter",u)}angular.module("app").controller("ShowDetailController",e),e.$inject=["ShowDetailModel","Posts","Comments","MainModel","$stateParams","$scope","Message","Favorite"]}(),function(){"use strict";function e(){var e={current:{id:"",comments:[],photos:[{url:""}],content:"",title:"",category:"SHOW-POST",createdBy:{nickname:""},likes:""}};return e}angular.module("app").factory("ShowDetailModel",e)}(),function(){"use strict";function e(e,t,o,n,r){function a(e){o.go("main.show.detail",{id:e.id})}function i(){var o=e.postsWrapper.posts;t.getPosts({category:"SHOW-POST",limit:10,newerThan:o[0]&&o[0].id,populates:"photos"}).$promise.then(function(e){e.posts.length||r.popUp.alert["default"]("새로운포스트가 없습니다","나중에 다시 확인해주세요"),e.posts.forEach(function(e){o.unshift(e)}),n.$broadcast("scroll.refreshComplete")},function(e){console.log(e),r.popUp.alert["default"](),n.$broadcast("scroll.refreshComplete")})}function s(){var o=e.postsWrapper.posts;t.getPosts({category:"SHOW-POST",sort:"id DESC",limit:10,olderThan:o[o.length-1]&&o[o.length-1].id,populates:"photos"}).$promise.then(function(t){t.posts.forEach(function(e){o.push(e)}),n.$broadcast("scroll.infiniteScrollComplete"),e.postsWrapper.more=t.more},function(e){console.log(e),r.popUp.alert["default"](),n.$broadcast("scroll.infiniteScrollComplete")})}function l(){return e.postsWrapper.more}function c(){e.postsWrapper.posts.length<10&&(r.loading["default"](),t.getPosts({category:"SHOW-POST",sort:"id DESC",limit:10,populates:"photos,comments,createdBy"}).$promise.then(function(t){console.log("this"),console.log(t),e.postsWrapper=t,r.loading.hide()},function(e){console.log(e),r.popUp.alert["default"]()}))}var u=this;u.Model=e,u.goToDetailHandler=a,u.getNewerPosts=i,u.getOlderPosts=s,u.checkForMore=l,n.$on("$ionicView.beforeEnter",c)}angular.module("app").controller("ShowListController",e),e.$inject=["ShowListModel","Posts","$state","$scope","Message"]}(),function(){"use strict";function e(){var e={postsWrapper:{posts:[{title:"",content:"",category:"",comments:[],photos:[{url:""}]}],more:!0}};return e}angular.module("app").factory("ShowListModel",e)}(),function(){"use strict";function e(e,t,o,n){function r(){e.posts=angular.fromJson(n.getItem("NAIL_SAVED_POSTS")),console.log("this"),console.log(e.posts)}function a(e){t.go("main.show.detail",{id:e.id})}var i=this;i.Model=e,i.goToDetailHandler=a,o.$on("$ionicView.beforeEnter",r)}angular.module("app").controller("SavedShowListController",e),e.$inject=["SavedShowListModel","$state","$scope","localStorage"]}(),function(){"use strict";function e(){var e={};return e}angular.module("app").factory("SavedShowListModel",e),e.$inject=[]}(),function(){"use strict";function e(e,t){function o(t,o){return e.go(t,o)}var n=this;n.Model=t,n.goToHandler=o}angular.module("app").controller("AnnouncementsController",e),e.$inject=["$state","AnnouncementsModel"]}(),function(){"use strict";function e(){var e={};return e}angular.module("app").factory("AnnouncementsModel",e)}(),function(){"use strict";function e(e){var t=this;t.Model=e}angular.module("app").controller("BalanceController",e),e.$inject=["BalanceModel"]}(),function(){"use strict";function e(){var e={};return e}angular.module("app").factory("BalanceModel",e)}(),function(){"use strict";function e(e,t,o,n,r,a,i){function s(){return t.getMyBookings({from:r().clone().subtract(1,"years").toDate().getTime(),to:r().clone().add(1,"years").toDate().getTime()}).$promise.then(function(t){console.log(t),e.current.bookings=t.bookings},function(e){o.popUp.alert["default"]("인터넷이 꺼져있습니다","인터넷을 연결해주세요."),console.log(e)})}function l(e,t){t.status=e,console.log(t),a({url:i+"/booking",method:"PUT",data:t}).success(function(e){console.log(e),o.loading.hide(),o.popUp.alert["default"]("예약취소 알림","예약이 취소 되었습니다.")}).error(function(e){console.log(e),o.loading.hide()})}function c(e){return"CANCELED"===e.status||"DONE"===e.status?!0:!1}function u(e){return"DONE"===e.status?"done":"not-done"}function d(){s()}var p=this;p.Model=e,p.cancelHandler=l.bind(null,"CANCELED"),p.isCanceledOrDone=c,p.isDone=u,n.$on("$ionicView.beforeEnter",d)}angular.module("app").controller("CancelController",e),e.$inject=["CancelModel","Bookings","Message","$scope","moment","$http","governorUrl"]}(),function(){"use strict";function e(){var e={current:{bookings:[{datetime:new Date,products:[{product:{name:"우늘 네일"},amount:1}],place:{name:"place1"},status:"CANCELLED"},{datetime:new Date,products:[{product:{name:"오늘 네일 2"},amount:1}],place:{name:"place2"},status:"PROCESSING"}]}};return e}angular.module("app").factory("CancelModel",e)}(),function(){"use strict";function e(e,t,o,n,r,a){function i(e,t){"homeInput"===e.from&&t.focusById("daum-map-search-input")}var s=this;s.Model=e,s.searchType="address",s.findMeThenSearchNearBy=e.findMeThenSearchNearBy,s.searchLocationNearBy=function(t){return"address"===s.searchType?e.searchLocationNearBy(t):e.searchPlaceByName(t)},s.goToDetailHandler=function(){e.modal.hide(),n.go("main.detail",{id:e.selectedPlace.id})},s.goToHandler=function(e,t){n.go(e,t)},s.selectedPlace=e.selectedPlace,o.$on("$ionicView.enter",function(){t.fromTemplateUrl("state/daumMap/placeModal.html",{scope:o,animation:"slide-in-up"}).then(function(t){e.modal=t}),e.domMap.relayout()}),o.$on("$ionicView.enter",function(){s.title="quick"===r.from?"바로서비스":"전체보기",i(r,a)})}angular.module("app").controller("DaumMapController",e),e.$inject=["DaumMapModel","$ionicModal","$scope","$state","$stateParams","Dom"]}(),function(){"use strict";function e(e,t,o,n,r,a,i,s,l,c,u){return{scope:{markerSrc:"@",markerClickedSrc:"@",markerWidth:"@",markerHeight:"@"},compile:function(n){function d(e,t){var n=p(),r=c.pluck(e,"id"),a=c.map(r,function(e){return o.getBookingsDateBetween({placeId:e,from:n.clone().set({hour:0,minute:0,second:0}).toDate().getTime(),to:n.clone().set({hour:23,minute:59,second:59}).toDate().getTime()}).$promise});return i.all(a).then(function(o){var r=m(e,o,g,n,t);if(0===r.length)return[];for(var a=e.length-1;a>=0;a--)"unavailable"===r[a]&&e.splice(a,1);return e},function(e){console.log(e)})}function p(){var e=u().get("minute"),t=null;return t=u().set(30>=e?{minutes:29}:{minutes:59})}function m(e,t,o,n,r){function i(e){var t=e.get("hours"),o=e.get("minutes"),n=String(t)+":"+String(o);return n}var s=n.clone().get("day"),l=[];angular.forEach(e,function(o,r){console.log(o);var a=o.openingHours[s].end.split(":"),i=a[0],c=a[1],d=u().set({hour:i,minutes:c});o.openingHours[s].start===o.openingHours[s].end?(e.splice(r,1,null),t.splice(r,1,null)):n.isAfter(d)?(e.splice(r,1,null),t.splice(r,1,null)):l.push(d)});var d=0;for(d=e.length-1;d>=0;d--)null===e[d]&&(e.splice(d,1),t.splice(d,1));if(0===e.length)return a.popUp.alert["default"]("바로검색 알림","현재 시각 주변에 운영하는 네일샵들이 없습니다. 내일 이용해주시거나, 다른 지역을 검색해주세요."),[];var p=c.map(t,function(e){return e.bookings});console.log("arrayOfBookings"),console.log(p);var m=c.map(p,function(e){return c.map(e,function(e){return e.products[0].product.duration})}),f=[];for(d=0;d<m.length;d++){var g=[],h=p[d],v=m[d],y=e[d];console.log("place"),console.log(y);for(var $=0;$<v.length;$++){var S=h[d],P=S.datetime,w=u(P),T=v[d],k=l[d];w.isBetween(n.clone(),n.clone().add(r,"minutes"))&&w.isBefore(k.clone())&&g.push(w);for(var M=Math.ceil(T/o),C=0;M>C;C++){var D=o*(C+1),E=w.clone().add(D,"minutes");E.isBetween(n.clone(),n.clone().add(r,"minutes"))&&E.isBefore(k.clone())&&g.push(E)}}f.push(g)}console.log("arrayOfBookingsMoment"),console.log(f);var b=[];for(d=0;d<f.length;d++){var L=f[d];console.log(L);var I=c.map(L,i);0===I.length&&(I=["available"]),b.push(I)}console.log("arrayOfTimeStrings"),console.log(b);var N=[];angular.forEach(b,function(e){var t=c.groupBy(e,function(e){return e});N.push(t)}),console.log("arrayOfGroupedTimeStrings"),console.log(N);var U=[];for(d=0;d<N.length;d++){var B=!1,O=e[d];for(var j in N[d])if(N[d][j].length<O.employee||"available"===j){U.push("available"),B=!0;break}B===!1&&U.push("unavailable")}return console.log("availabilities"),console.log(U),U}function f(o,n,r){angular.forEach(e.places,function(i,s){var c=i.location.coordinates[0],u=i.location.coordinates[1],d=new l.maps.LatLng(u,c),p=new l.maps.Marker({map:y,position:d,title:String(s),image:o,clickable:!0});l.maps.event.addListener(p,"click",function(){var i=this;r.$apply(function(){angular.forEach(e.markers,function(e){e.setImage(o)}),i.setImage(n);var r=Number(i.getTitle());a.loading["default"](),t.findById({id:e.places[r].id,populates:"photos"}).$promise.then(function(t){a.loading.hide(),e.selectedPlace=t,console.log(e.selectedPlace),e.modal.show()},function(e){console.log(e),a.loading.hide(),a.popUp.alert["default"]()})})}),e.markers.push(p)})}var g=30,h=n[0],v={center:new l.maps.LatLng(37.5,127),level:4,draggable:!0};l.maps.disableHD();var y=new l.maps.Map(h,v),$=new l.maps.services.Places,S=null,P=function(o,n,r,i){angular.forEach(e.markers,function(e){e.setMap(null)}),e.markers=[],t.getPlacesWithin({latitude:o.latitude,longitude:o.longitude,distance:o.distance||5e3,limit:o.limit||50,filter:S||null}).$promise.then(function(t){"quick"===s.from?d(t.places,60).then(function(t){e.places=t,f(n,r,i)},function(e){console.log(e)}):(e.places=t.places,f(n,r,i)),a.loading.hide(),S=null},function(e){console.log(e),S=null})};return e.findMeThenSearchNearBy=function(){a.loading["default"](),r.getCurrentPosition({maximumAge:3e3,timeout:5e3}).then(function(t){return null==t.coords?(a.loading.hide(),a.popUp.alert["default"]("위치 공유가 꺼져있습니다.","위치 공유를 켜주세요."),!1):(e.currentPosition={latitude:t.coords.latitude,longitude:t.coords.longitude},y.setCenter(new l.maps.LatLng(e.currentPosition.latitude,e.currentPosition.longitude)),void a.loading.hide())},function(e){console.log(e),a.loading.hide(),a.popUp.alert["default"]("위치 공유가 꺼져있습니다.","위치 공유를 켜주세요.")})},e.searchLocationNearBy=function(e){return a.loading["default"](),e?void $.keywordSearch(e,function(e,t){return void 0===t.places[0]?(a.loading.hide(),a.popUp.alert["default"]("요청하신 장소가 없습니다","다시검색해주세요"),!1):(console.log(e),y.panTo(new l.maps.LatLng(t.places[0].latitude,t.places[0].longitude)),void a.loading.hide())},function(e){console.log(e),console.log(e),a.loading.hide(),a.popUp.alert["default"]({title:"위치 공유가 꺼져있습니다.",template:"위치 공유 켜주세요."})}):(a.loading.hide(),a.popUp.alert["default"]("검색하기 알림","장소 값을 넣어서 다시 검색해주세요"),!1)},e.searchPlaceByName=function(e){return a.loading["default"](),e?(S=e,void t.getPlaces({category:"NAIL-PLACE",filter:e,limit:50}).$promise.then(function(e){return e.places&&e.places.length>0?(y.panTo(new l.maps.LatLng(e.places[0].location.coordinates[1],e.places[0].location.coordinates[0])),void a.loading.hide()):(a.loading.hide(),a.popUp.alert["default"]("요청하신 장소가 없습니다","다시검색해주세요"),!1)},function(e){console.log(e)})):(a.loading.hide(),a.popUp.alert["default"]("검색하기 알림","장소 값을 넣어서 다시 검색해주세요"),!1)},function(t){var o=new l.maps.Size(Number(t.markerWidth),Number(t.markerHeight)),n=new l.maps.MarkerImage(t.markerSrc,o),r=new l.maps.MarkerImage(t.markerClickedSrc,o);y.relayout(),e.domMap=y,l.maps.event.addListener(y,"idle",function(){a.loading["default"]();var e={longitude:y.getCenter().getLng(),latitude:y.getCenter().getLat()};angular.extend(e,{distance:2e3,limit:20}),console.log(e),P(e,n,r,t)})}}}}angular.module("app").directive("daumMap",e),e.$inject=["DaumMapModel","Places","Bookings","$state","$cordovaGeolocation","Message","$q","$stateParams","daum","_","moment"]}(),function(){"use strict";function e(){var e={category:"NAIL-PLACE",currentPosition:{latitude:"FLOAT",longitude:"FLOAT"},markers:[],places:[],selectedPlace:{},modal:{},findMeThenSearchNearBy:function(){},searchLocationNearBy:function(){}};return e}angular.module("app").factory("DaumMapModel",e)}(),function(){"use strict";function e(e,t,o,n){function r(e){o.go("main.detail",{id:e.id})}function a(){e.placeList=angular.fromJson(n.getItem("NAIL_SAVED_PLACES"))}var i=this;i.Model=e,i.goToDetailHandler=r,t.$on("$ionicView.beforeEnter",a)}angular.module("app").controller("FavoriteController",e),e.$inject=["FavoriteModel","$scope","$state","localStorage"]}(),function(){"use strict";function e(){var e={};return e}angular.module("app").factory("FavoriteModel",e)}(),function(){"use strict";function e(e,t,o,n){function r(){return t.loginWithFacebook().then(function(e){console.log(e),o.loading.hide(),n.go("main.home")},function(e){console.log(e)})}function a(){return t.loginWithKakao().then(function(e){console.log(e),o.loading.hide(),n.go("main.home")},function(e){console.log(e)})}var i=this;i.Model=e,i.loginWithFaceBook=r,i.loginWithKaKaoTalk=a}angular.module("app").controller("LoginController",e),e.$inject=["LoginModel","AuthService","Message","$state"]}(),function(){"use strict";function e(){var e={};return e}angular.module("app").factory("LoginModel",e)}(),function(){"use strict";function e(e,t,o,n,r,a,i,s,l,c){function u(){return n.loading["default"](),r.findById({id:t.id,populates:"photos,products,bookings"}).$promise.then(function(t){e.current=t,console.log("this"),console.log(t),f.interiorPhotos=m(e.current.photos,"INTERIOR"),n.loading.hide(),a.update()},function(e){console.log(e),n.popUp.alert["default"]("네일샵정보 알림","요청하신 네일샵은 더이상 존재하지 않습니다.")})}function d(){return r.getPlacePhotos({id:t.id,tags:"PORTFOLIO"}).$promise.then(function(e){f.portFolioPhotos=e,console.log(e)},function(e){console.log(e)})}function p(){u(),d()}var m=l("filterByTag"),f=this;f.Model=e,f.date=c(),f.isFavorite=s.isFavorite.bind(null,"NAIL_SAVED_PLACES"),f.interiorPhotos=[],f.portFolioPhotos=[],f.toggleSavePlace=s.saveToFavorite.bind(null,"NAIL_SAVED_PLACES",f,e),o.$on("$ionicView.beforeEnter",p)}angular.module("app").controller("DetailController",e),e.$inject=["DetailModel","$stateParams","$scope","Message","Places","$ionicSlideBoxDelegate","$state","Favorite","$filter","moment"]}(),function(){"use strict";function e(e,t,o,n){var r={current:{openingHours:[{start:"00:00",end:"00:00"},{start:"07:00",end:"20:00"},{start:"07:00",end:"20:00"},{start:"07:00",end:"20:00"},{start:"07:00",end:"20:00"},{start:"09:00",end:"22:00"},{start:"09:00",end:"22:00"}]},selectedDate:{current:"BOOL",customClass:"STRING",date:"DATE",disabled:"BOOL"},dayClickHandler:function(e){var r=o.id;console.log(r);var a=n(e.date);t.go("main.schedule",{id:r,selectedDate:a.format("YYYY-MM-DD")})}};return r}angular.module("app").factory("DetailModel",e),e.$inject=["$q","$state","$stateParams","moment"]}(),function(){"use strict";function e(e,t,o,n,r,a,i,s,l,c,u,d){function p(){e.toggleLeft()}function m(n){t.currentItem=n,o.go(n.state),e.toggleLeft(!1)}function f(){return a.currentStateName()}function g(){S.settingSubMenu=!S.settingSubMenu}function h(){t.setting.pushNotification=t.setting.pushNotification===!0?!1:!0,u.updateDeviceToken(t.setting.pushNotification)}function v(){o.go("main.daumMap")}function y(){var e=angular.fromJson(i.getItem(l+"_auth_token"));angular.copy(e.user,t.user),console.log(t.user)}function $(){var e="User"+t.user.username;return t.user.nickname&&(e=t.user.nickname),e}var S=this;S.Model=t,S.toggleSideMenu=p,S.menuSelectHandler=m,S.getCurrentState=f,S.toggleAccordion=g,S.togglePushHandler=h,S.goToDaumMapHandler=v,S.displayUserName=$,d.user=t.user,s.$on("$ionicView.beforeEnter",y)}angular.module("app").controller("MainController",e),e.$inject=["$ionicSideMenuDelegate","MainModel","$state","$timeout","$ionicNavBarDelegate","$ionicHistory","localStorage","$scope","appName","Devices","PushService","$rootScope"]}(),function(){"use strict";function e(){var e={user:{id:"test55cc92edc96284828b826258",username:"test49720641",nickname:"test",profile_image:"http://mud-kage.kakao.co.kr/14/dn/btqcfpt4vNR/Fmmz6xsVRH05wv1UYNniRK/o.jpg",thumbnail_image:"http://mud-kage.kakao.co.kr/14/dn/btqcfp1VCch/LjjO9lFj9uwxpOB59NHEnK/o.jpg"},sideMenuLists:[{state:"main.home",text:"홈으로 가기"},{state:"main.show.savedList",text:"마이갤러리"},{state:"main.balance.list",text:"적립금 확인"},{state:"main.cancel",text:"예약 취소"},{state:"main.announcements.eventList",text:"이벤트 / 공지사항"}],currentItem:{state:"main.home",text:"홈으로 가기"},setting:{pushNotification:!0}};return e}angular.module("app").factory("MainModel",e)}(),function(){"use strict";function e(e,t){function o(e,o){t.go(e,o)}function n(e){console.log(e),t.go("main.daumMap",{from:"homeInput"})}var r=this;r.search="",r.goToHandler=o,r.searchHandler=n}angular.module("app").controller("MainHomeController",e),e.$inject=["MainHomeModel","$state"]}(),function(){"use strict";function e(){var e={};return e}angular.module("app").factory("MainHomeModel",e)}(),function(){"use strict";function e(e,t,o,n,r,a,i,s,l,c,u,d,p){function m(o,n){return t.selectedSlot=o,t.selectedIndex=n,o.bookingCount>=e.current.employee?(r.popUp.alert["default"]("예약불가 알림","예약이 꽉 차있는 시간입니다."),!1):(E.modal.show(),void(t.form.datetime=o.toDate()))}function f(e){var o=t.selectedSlot.get&&t.selectedSlot.get("hour"),n=t.selectedSlot.get&&t.selectedSlot.get("minute"),r=o+":"+n,a=e.get&&e.get("hour"),i=e.get&&e.get("minute"),s=a+":"+i;return r===s}function g(t){return null!=t.bookingCount&&null!=e.current.employee?Number(e.current.employee)>t.bookingCount:!0}function h(e){t.form.products=[{product:e}]}function v(e){return(t.form.products&&t.form.products[0]&&t.form.products[0].product.id)===e.id}function y(){n.getBookingsDateBetween({placeId:l.id,from:d(l.selectedDate).clone().toDate().getTime(),to:d(l.selectedDate).clone().add(1,"days").toDate().getTime()}).$promise.then(function(o){t.viewSlots=P(l.selectedDate,e.current.openingHours,30,!0),w(o),angular.copy({},t.form),E.modal.hide()})}function $(){return t.form.place=l.id,t.form.category="NAIL-BOOKING",t.form.products?null==t.form.products[0]?C("서비스란"):null==t.form.userKoreanName?C("이름란"):null==t.form.userPhoneNumber?C("연락처란"):(r.loading["default"](),void n.getBookingsDateBetween({placeId:l.id,from:d(l.selectedDate).clone().toDate().getTime(),to:d(l.selectedDate).clone().add(1,"days").toDate().getTime()}).$promise.then(function(o){t.viewSlots=P(l.selectedDate,e.current.openingHours,30,!0),w(o);var n=k();n&&M()},function(e){console.log(e)})):(r.loading.hide(),void r.popUp.alert["default"]("예약 불가 안내","현재 예약시스템을 준비 중인 샵입니다.").then(function(e){console.log(e),E.closeModalHandler()}))}function S(){var o=e.current.openingHours;t.viewSlots=P(l.selectedDate,o,30,!0),n.getBookingsDateBetween({placeId:l.id,from:d(l.selectedDate).clone().toDate().getTime(),to:d(l.selectedDate).clone().add(1,"days").toDate().getTime()}).$promise.then(function(e){console.log(e),w(e)},function(e){console.log(e)})}function P(e,t,o,n){var r=d(e).set({hour:0,minute:0,second:0}),a=r.day(),i=t[a],s=i.start.split(":"),l=i.end.split(":"),c=s[0],u=s[1],m=l[0],f=l[1],g=60*Number(c)+Number(u),h=n?60*Number(m)+Number(f)+o:60*Number(m)+Number(f),v=p.range(g,h,o),y=[];return angular.forEach(v,function(e){var t=r.clone(),o=t.set({minute:e,second:0});y.push(o)}),y}function w(e){var o=t.viewSlots,n=t.bookings=e.bookings;angular.forEach(n,function(e){for(var t=d.utc(e.datetime).local().add(1,"seconds"),n=e.products[0].product&&e.products[0].product.duration,r="",a=0;a<o.length;a++)if(a<o.length-1?r=o[a+1]:a===o.length-1&&(r=o[a].clone().add(D,"minutes")),t.isBetween(o[a],r)){for(var i=Math.ceil(Number(n)/Number(D)),s=0;i>s;s++)o[a+s].bookingCount?o[a+s].bookingCount+=1:o[a+s].bookingCount=1;break}})}function T(){i.fromTemplateUrl("state/schedule/reserveModal.html",{scope:a,animation:"slide-in-up"}).then(function(e){E.modal=e})}function k(){var o=t.selectedIndex;if(!t.form.products[0].product)return r.loading.hide(),r.popUp.alert["default"]("예약 불가 안내","현재 예약시스템을 준비 중인 샵입니다.").then(function(e){console.log(e),E.closeModalHandler()}),!1;for(var n=t.form.products[0].product.duration,a=Math.ceil(n/D),i=o;o+a>i;i++){var s=t.viewSlots[i].bookingCount?t.viewSlots[i].bookingCount:0;if(s>=Number(e.current.employee))return r.loading.hide(),r.popUp.alert["default"]("예약 불가 안내","고르신 서비스의 시간이 다음 예약시간과 겹치게 되어 예약이 불가합니다."),!1;if(o+a>t.viewSlots.length)return r.loading.hide(),r.popUp.alert["default"]("예약 불가 안내","고르신 서비스의 마무리시간이 영업 종료시간을 넘기어 예약이 불가합니다."),!1}return!0}function M(){return Array.isArray(E.Model.form.products)&&0!==E.Model.form.products.length?n.requestBooking({},E.Model.form).$promise.then(function(e){r.loading.hide(),r.popUp.alert["default"]("예약 완료 알림","예약이 완료 되었습니다.").then(function(e){console.log(e),E.closeModalHandler()}),console.log(e)},function(e){r.loading.hide(),console.log(e)}):(r.loading.hide(),void r.popUp.alert["default"]("부킹가능한 상품이 없습니다.","부킹가능한 상품을 준비 중입니다.").then(function(e){console.log(e),E.closeModalHandler()}))}function C(e){r.popUp.alert["default"](e+"이 비었습니다.",e+"을 입력/골라 주세요.")}var D=30,E=this;E.Model=t,t.current=e.current,E.selectSlotHandler=m,E.isSelectedSlot=f,E.isAvailableSlot=g,E.selectProductHandler=h,E.isSelectedProduct=v,E.closeModalHandler=y,E.bookingHandler=$,a.$on("$ionicView.beforeEnter",S),a.$on("$ionicView.afterEnter",T)}angular.module("app").controller("ScheduleController",e),e.$inject=["DetailModel","ScheduleModel","Places","Bookings","Message","$scope","$ionicModal","$q","$stateParams","$http","governorUrl","moment","_"]}(),function(){"use strict";function e(){var e={current:{openingHours:[{start:"00:00",end:"00:00"},{start:"07:00",end:"20:00"},{start:"07:00",end:"20:00"},{start:"07:00",end:"20:00"},{start:"07:00",end:"20:00"},{start:"09:00",end:"22:00"},{start:"09:00",end:"22:00"}]},selectedSlot:{},viewSlots:["moment","moment","moment"],bookings:[{datetime:"datetime",products:[{duration:"30"}]}],form:{products:[""],userKoreanName:null,userPhoneNumber:null,datetime:new Date,place:"placeId",category:"NAIL-BOOKING"}};return e}angular.module("app").factory("ScheduleModel",e)}(),function(){"use strict";function e(e,t,o,n,r,a,i,s,l,c,u){function d(){var e=a.postsWrapper.posts;t.getPosts({category:"SHOW-POST",limit:10,newerThan:e[0]&&e[0].id,populates:"photos,createdBy"}).$promise.then(function(t){console.log("this"),console.log(t),t.posts.forEach(function(t){e.unshift(t)})},function(e){console.log(e),s.popUp.alert["default"]()})}var p=this;n.fromTemplateUrl("state/show/showModal.html",{scope:r,animation:"slide-in-up"}).then(function(e){p.modal=e}),p.modalHideHandler=function(){p.writeImageSrc=null,p.writeTitle=null,p.writeContent=null,p.modal.hide()},p.modalShowHandler=function(){p.modal.show()},p.goToSavedPostListHandler=function(){o.go("main.show.savedList")},p.showWriteImage=function(){return null!=p.writeImageSrc},p.getPictureHandler=function(e){void 0===e&&(e=1),console.log(e);var t={allowEdit:!0,quality:50,destinationType:Camera.DestinationType.FILE_URI,encodingType:Camera.EncodingType.JPEG,correctOrientation:!0,targetWidth:500,mediaType:Camera.MediaType.PICTURE,cameraDirection:Camera.Direction.BACK,sourceType:e};i.getPicture(t).then(function(e){p.writeImageFile=e;var t=e.substr(e.lastIndexOf("/")+1),o=e.substr(0,e.lastIndexOf("/")+1);u.readAsDataURL(o,t).then(function(e){console.log(e),p.writeImageSrc=e},function(e){console.log(e)})},function(e){console.log(e)})},p.postHandler=function(){s.loading["default"]();var e={category:"SHOW-POST",title:p.writeTitle,content:p.writeContent,file:p.writeImageFile};t.createPostWithImage({},e).$promise.then(function(){p.writeTitle="",p.writeContent="",p.writeImageSrc=null,p.writeImageFile="",d(),s.loading.hide(),s.message.success("포스트가 만들어졌습니다."),p.modal.hide()},function(e){console.log(e),s.loading.hide(),s.message.error("다시 시도해주세요.")},function(e){console.dir(e)})}}angular.module("app").controller("ShowController",e),e.$inject=["ShowModel","Posts","$state","$ionicModal","$scope","ShowListModel","$cordovaCamera","Message","$timeout","$window","$cordovaFile"]}(),function(){"use strict";function e(){var e={};return e}angular.module("app").factory("ShowModel",e)}();